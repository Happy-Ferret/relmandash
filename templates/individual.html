{% extends "layout.html" %}
{% block body %}
<script type=text/javascript>
    $(function() { 
        $("#sectable").tablesorter();
        $("#betatable").tablesorter();
        $("#auroratable").tablesorter();
        $("#esrtable").tablesorter();
        $("#nomtable").tablesorter();
        $("#approvetable").tablesorter();
        $("#uptable").tablesorter();
        $("#infotable").tablesorter();
        $("#tabs").tabs();
    }); 
</script>
    <h2>{{ email }}</h2>
    {% if error %}<p class=error><strong>Error:</strong> {{ error }}
    {% else %}
    <div id="tabs">
        <ul>
            <li><a href="#tab_main">Main</a></li>
            {% if nominate %}
            <li><a href="#tab_nomination">Awaiting nomination</a></li>
            {% endif %}
            {% if approve %}
            <li><a href="#tab_approve">Awaiting approval</a></li>
            {% endif %}
            {% if uplift %}
            <li><a href="#tab_uplift">Approved for uplifting</a></li>
            {% endif %}
            {% if needsInfo %}
            <li><a href="#tab_info">Needs info</a></li>
            {% endif %}
        </ul>
    <div id="tab_main">
        {% if security %}
        <h3>Security critical bugs ({{ security|length }})</h3>
            <table id="sectable" class="tablesorter">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Severity</th>
                    <th>Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in security %}
                <tr class="security">
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
        {% if beta %}
        <h3>Beta ({{ beta|length }})</h3>
            <table id="betatable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in beta %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
        {% if aurora %}
            <h3>Aurora ({{ aurora|length }})</h3>
            <table id="auroratable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in aurora %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
        
        {% if esr %}
        <h3>ESR ({{ esr|length }})</h3>
            <table id="esrtable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in esr %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    <div id="tab_nomination">
        {% if nominate %}
        <h3>To nominate ({{ nominate|length }})</h3>
            <table id="nomtable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in nominate %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    <div id="tab_approve">
        {% if approve %}
        <h3>Waiting for approval ({{ approve|length }})</h3>
            <table id="approvetable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in approve %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    <div id="tab_uplift">
        {% if uplift %}
         <h3>Approved, waiting to be uplifted ({{ uplift|length }})</h3>
            <table id="uptable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in uplift %}
                <tr>
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    <div id="tab_info">
        {% if needsInfo %}
         <h3>Requires your response ({{ needsInfo|length }})</h3>
            <table id="infotable" class="tablesorter">
                <thead>
                <tr>
                    <th class="id">ID</th>
                    <th class="sev">Severity</th>
                    <th class="pri">Priority</th>
                    <th>Summary</th>
                </tr>
                </thead>
                <tbody>
            {% for bug in needsInfo %}
                <tr 
                {% for group in bug.groups %}
                    {% if group.name == "core-security" %}
                        class="security"
                    {% endif %}
                {% endfor %}
                >
                    <td>
                        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{bug.id}}">
                            {{bug.id}}</a>
                    </td>
                    <td>{{bug.severity}}</td>
                    <td>{{bug.priority}}</td>
                    <td>{{bug.summary}}</td>
                </tr>
            {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    </div>
    {% endif %}
    {% if keywords %}
    <form>
        {% for keyword in keywords%}
            <input type="checkbox" name="{{ keyword }}" value="{{ keyword }}">{{ keyword }}
        {% endfor %}
    </form>
    {% endif %}
{% endblock %}
